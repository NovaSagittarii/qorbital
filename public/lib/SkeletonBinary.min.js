function SkeletonBinary(){}SkeletonBinary.prototype={data:null,scale:1,json:{},nextNum:0,chars:null,readByte:function(){return this.nextNum<this.data.length?this.data[this.nextNum++]:null},readBoolean:function(){return 0!=this.readByte()},readShort:function(){return this.readByte()<<8|this.readByte()},readInt:function(t){if(void 0===t)return this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte();var e=this.readByte(),a=127&e;return 0!=(128&e)&&(a|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<28)))),t?a:a>>1^-(1&a)},bytes2Float32:function(t){var e=2147483648&t?-1:1,a=(t>>23&255)-127,r=8388607&t;if(128==a)return e*(r?Number.NaN:Number.POSITIVE_INFINITY);if(-127==a){if(0==r)return 0*e;a=-126,r/=1<<22}else r=(r|1<<23)/(1<<23);return e*r*Math.pow(2,a)},readFloat:function(){return this.bytes2Float32((this.readByte()<<24)+(this.readByte()<<16)+(this.readByte()<<8)+(this.readByte()<<0))},readVertices:function(t){var e=t<<1;if(!this.readBoolean())return this.readFloatArray(e,this.scale);for(var a=new Array,r=0;r<t;r++){var s=this.readInt(!0);a.push(s);for(var i=0;i<s;i++)a.push(this.readInt(!0)),a.push(this.readFloat()*this.scale),a.push(this.readFloat()*this.scale),a.push(this.readFloat())}return a},readFloatArray:function(t,e){var a=new Array(t);if(1==e)for(var r=0;r<t;r++)a[r]=this.readFloat();else for(r=0;r<t;r++)a[r]=this.readFloat()*e;return a},readShortArray:function(){for(var t=this.readInt(!0),e=new Array(t),a=0;a<t;a++)e[a]=this.readShort();return e},readIntArray:function(){for(var t=this.readInt(!0),e=new Array(t),a=0;a<t;a++)e[a]=this.readInt(!0);return e},readHex:function(){var t=this.readByte().toString(16);return 2==t.length?t:"0"+t},readColor:function(){return this.readHex()+this.readHex()+this.readHex()+this.readHex()},readString(){var t=this.readInt(this,!0);switch(t){case 0:return null;case 1:return""}t--,this.chars="";for(var e=0,a=0;a<t;)switch((e=this.readByte())>>4){case 12:case 13:this.chars+=String.fromCharCode((31&e)<<6|63&this.readByte()),a+=2;break;case 14:this.chars+=String.fromCharCode((15&e)<<12|(63&this.readByte())<<6|63&this.readByte()),a+=3;break;default:this.chars+=String.fromCharCode(e),a++}return this.chars},initJson:function(){this.json.skeleton={};var t=this.json.skeleton;t.hash=this.readString(),0==t.hash.length&&(t.hash=null),t.spine=this.readString(),0==t.spine.length&&(t.spine=null),t.width=this.readFloat(),t.height=this.readFloat();var e=this.readBoolean();e&&(t.fps=this.readFloat(),t.images=this.readString(),0==t.images.length&&(t.images=null)),this.json.bones=new Array(this.readInt(!0));for(var a=this.json.bones,r=0;r<a.length;r++){if((h={}).name=this.readString(),h.parent=null,0!=r){var s=this.readInt(!0);h.parent=a[s].name}h.rotation=this.readFloat(),h.x=this.readFloat()*this.scale,h.y=this.readFloat()*this.scale,h.scaleX=this.readFloat(),h.scaleY=this.readFloat(),h.shearX=this.readFloat(),h.shearY=this.readFloat(),h.length=this.readFloat()*this.scale,h.transform=TransformMode[this.readInt(!0)],e&&(h.color=this.readColor()),a[r]=h}this.json.slots=new Array(this.readInt(!0));var i=this.json.slots;for(r=0;r<i.length;r++){var n={};n.name=this.readString();var h=this.json.bones[this.readInt(!0)];n.bone=h.name,n.color=this.readColor(),t.spine.startsWith("3.6")&&(n.dark=this.readColor()),n.attachment=this.readString(),n.blend=BlendMode[this.readInt(!0)],i[r]=n}this.json.ik=new Array(this.readInt(!0));var o=this.json.ik;for(r=0;r<o.length;r++){var d={};d.name=this.readString(),d.order=this.readInt(!0),d.bones=new Array(this.readInt(!0));for(var l=0;l<d.bones.length;l++)d.bones[l]=this.json.bones[this.readInt(!0)].name;d.target=this.json.bones[this.readInt(!0)].name,d.mix=this.readFloat(),d.bendPositive=255!=this.readByte(),o[r]=d}this.json.transform=new Array(this.readInt(!0));var c=this.json.transform;for(r=0;r<c.length;r++){var v={};v.name=this.readString(),v.order=this.readInt(!0);for(var m=0,f=(a=new Array(this.readInt(!0))).length;m<f;m++)a[m]=this.json.bones[this.readInt(!0)].name;v.bones=a,v.target=this.json.bones[this.readInt(!0)].name,t.spine.startsWith("3.6")&&(v.local=this.readBoolean(),v.relative=this.readBoolean()),v.rotation=this.readFloat(),v.x=this.readFloat()*this.scale,v.y=this.readFloat()*this.scale,v.scaleX=this.readFloat(),v.scaleY=this.readFloat(),v.shearY=this.readFloat(),v.rotateMix=this.readFloat(),v.translateMix=this.readFloat(),v.scaleMix=this.readFloat(),v.shearMix=this.readFloat(),c[r]=v}this.json.path=new Array(this.readInt(!0));var u=this.json.path;for(r=0;r<u.length;r++){var g={};g.name=this.readString(),g.order=this.readInt(!0),g.bones=new Array(this.readInt(!0));for(m=0,f=g.bones.length;m<f;m++)g.bones[m]=this.json.bones[this.readInt(!0)].name;g.target=this.json.slots[this.readInt(!0)].name,g.positionMode=PositionMode[this.readInt(!0)],g.spacingMode=SpacingMode[this.readInt(!0)],g.rotateMode=RotateMode[this.readInt(!0)],g.rotation=this.readFloat(),g.position=this.readFloat(),"fixed"==g.positionMode&&(g.position*=this.scale),g.spacing=this.readFloat(),"length"!=g.spacingMode&&"fixed"!=g.spacingMode||(g.spacing*=this.scale),g.rotateMix=this.readFloat(),g.translateMix=this.readFloat(),u[r]=g}this.json.skins={},this.json.skinsName=new Array;var y=this.json.skins,F=this.readSkin("default",e);null!=F&&(y.default=F,this.json.skinsName.push("default"));r=0;for(var I=this.readInt(!0);r<I;r++){var p=this.readString(),x=this.readSkin(p,e);y[p]=x,this.json.skinsName.push(p)}this.json.events=[],this.json.eventsName=[];var S=this.json.events;for(r=0,I=this.readInt(!0);r<I;r++){var M=this.readString(),j={};j.int=this.readInt(!1),j.float=this.readFloat(),j.string=this.readString(),S[M]=j,this.json.eventsName[r]=M}this.json.animations={};var w=this.json.animations;for(r=0,I=this.readInt(!0);r<I;r++){var B=this.readString(),A=this.readAnimation(B);w[B]=A}},readSkin(t,e){var a=this.readInt(!0);if(0==a)return null;for(var r={},s=0;s<a;s++){for(var i=this.readInt(!0),n={},h=0,o=this.readInt(!0);h<o;h++){var d=this.readString(),l=this.readAttachment(d,e);null!=l&&(n[d]=l)}r[this.json.slots[i].name]=n}return r},readAttachment(t,e){var a=this.scale,r=this.readString();switch(null==r&&(r=t),AttachmentType[this.readByte()]){case"region":null==(d=this.readString())&&(d=r);var s={type:"region"};return s.name=r,s.path=d.trim(),s.rotation=this.readFloat(),s.x=this.readFloat()*a,s.y=this.readFloat()*a,s.scaleX=this.readFloat(),s.scaleY=this.readFloat(),s.width=this.readFloat()*a,s.height=this.readFloat()*a,s.color=this.readColor(),s;case"boundingbox":var i={type:"boundingbox"};i.name=r;var n=this.readInt(!0);return i.vertexCount=n,i.vertices=this.readVertices(n),this.nonessential&&(i.color=this.readColor()),i;case"mesh":null==(d=this.readString())&&(d=r);var h={type:"mesh"};h.name=r,h.path=d,h.color=this.readColor();n=this.readInt(!0);return h.uvs=this.readFloatArray(n<<1,1),h.triangles=this.readShortArray(),h.vertices=this.readVertices(n),h.hull=this.readInt(!0)<<1,e&&(h.edges=this.readShortArray(),h.width=this.readFloat()*a,h.height=this.readFloat()*a),h;case"linkedmesh":null==(d=this.readString())&&(d=r);var o={type:"linkedmesh"};return o.name=r,o.path=d,o.color=this.readColor(),o.skin=this.readString(),o.parent=this.readString(),o.deform=this.readBoolean(),e&&(o.width=this.readFloat()*a,o.height=this.readFloat()*a),o;case"path":var d;(d={type:"path"}).name=r,d.closed=this.readBoolean(),d.constantSpeed=this.readBoolean();n=this.readInt(!0);d.vertexCount=n,d.vertices=this.readVertices(n);for(var l=new Array(n/3),c=0;c<l.length;c++)l[c]=this.readFloat()*a;return d.lengths=l,e&&(d.color=this.readColor()),d;case"point":var v={type:"point"};return v.name=r,v.rotation=this.readFloat(),v.x=this.readFloat()*a,v.y=this.readFloat()*a,e&&(d.color=this.readColor()),v;case"clipping":var m={type:"clipping"};m.name=r,m.end=this.readInt(!0);n=this.readInt(!0);return m.vertexCount=n,m.vertices=this.readVertices(n),e&&(m.color=this.readColor()),m}return null},readCurve(t,e){switch(this.readByte()){case 0:e[t].curve="linear";break;case 1:e[t].curve="stepped";break;case 2:var a=this.readFloat(),r=this.readFloat(),s=this.readFloat(),i=this.readFloat();e[t].curve=[a,r,s,i]}},readAnimation(t){for(var e={},a=this.scale,r=0,s={},i=0,n=this.readInt(!0);i<n;i++){for(var h=this.readInt(!0),o={},d=this.readInt(!0),l=0;l<d;l++){var c=this.readByte(),v=this.readInt(!0);switch(c){case 0:for(var m=new Array(v),f=0;f<v;f++){var u=this.readFloat(),g=this.readString();m[f]={},m[f].time=u,m[f].name=g}o.attachment=m,r=Math.max(r,m[v-1].time);break;case 1:for(m=new Array(v),f=0;f<v;f++){u=this.readFloat();var y=this.readColor();if(m[f]={},m[f].time=u,m[f].color=y,f<v-1)this.readCurve(f,m)}o.color=m,r=Math.max(r,m[v-1].time);break;case 2:for(m=new Array(v),f=0;f<v;f++){u=this.readFloat();var F=this.readColor(),I=this.readColor();if(m[f]={},m[f].time=u,m[f].light=F,m[f].dark=I,f<v-1)this.readCurve(f,m)}o.twoColor=m,r=Math.max(r,m[v-1].time)}}s[this.json.slots[h].name]=o}e.slots=s;var p={};for(i=0,n=this.readInt(!0);i<n;i++){for(var x=this.readInt(!0),S={},M=(l=0,this.readInt(!0));l<M;l++){c=this.readByte(),v=this.readInt(!0);switch(c){case 0:for(m=new Array(v),f=0;f<v;f++){u=this.readFloat();var j=this.readFloat();m[f]={},m[f].time=u,m[f].angle=j,f<v-1&&this.readCurve(f,m)}S.rotate=m,r=Math.max(r,m[v-1].time);break;case 1:case 2:case 3:m=new Array(v);var w=1;1==c&&(w=a);for(f=0;f<v;f++){var B=this.readFloat(),A=this.readFloat(),b=this.readFloat();m[f]={},m[f].time=B,m[f].x=A*w,m[f].y=b*w,f<v-1&&this.readCurve(f,m)}1==c?S.translate=m:2==c?S.scale=m:S.shear=m,r=Math.max(r,m[v-1].time)}}p[this.json.bones[x].name]=S}e.bones=p;var C={};for(i=0,n=this.readInt(!0);i<n;i++){var k=this.readInt(!0);for(v=this.readInt(!0),m=new Array(v),f=0;f<v;f++){u=this.readFloat();var N=this.readFloat(),T=255!=this.readByte();m[f]={},m[f].time=u,m[f].mix=N,m[f].bendPositive=T,f<v-1&&this.readCurve(f,m)}C[this.json.ik[k].name]=m,r=Math.max(r,m[v-1].time)}e.ik=C;var V={};for(i=0,n=this.readInt(!0);i<n;i++){var Y=this.readInt(!0);for(v=this.readInt(!0),m=new Array(v),f=0;f<v;f++)m[f]={},m[f].time=this.readFloat(),m[f].rotateMix=this.readFloat(),m[f].translateMix=this.readFloat(),m[f].scaleMix=this.readFloat(),m[f].shearMix=this.readFloat(),f<v-1&&this.readCurve(f,m);V[this.json.transform[Y].name]=m,r=Math.max(r,m[v-1].time)}e.transform=V;var H={};for(i=0,n=this.readInt(!0);i<n;i++){var P=this.readInt(!0),R=this.json.path[P],O={};for(l=0,M=this.readInt(!0);l<M;l++){c=this.readByte(),v=this.readInt(!0);switch(c){case 0:case 1:m=new Array(v),w=1;1==c?"length"!=R.spacingMode&&"fixed"!=R.spacingMode||(w=this.scale):"fixed"==R.positionMode&&(w=this.scale);for(f=0;f<v;f++){u=this.readFloat();var X=this.readFloat();m[f]={},m[f].time=u,0==c?m[f].position=X*w:m[f].spacing=X*w,f<v-1&&this.readCurve(f,m)}0==c?O.position=m:O.spacing=m,r=Math.max(r,m[v-1].time);break;case 2:for(m=new Array(v),f=0;f<v;f++){u=this.readFloat();var W=this.readFloat(),E=this.readFloat();m[f]={},m[f].time=u,m[f].rotateMix=W,m[f].translateMix=E,f<v-1&&this.readCurve(f,m)}O.mix=m,r=Math.max(r,m[v-1].time)}}H[this.json.path[P].name]=O}e.paths=H;var J={};for(i=0,n=this.readInt(!0);i<n;i++){var _=this.readInt(!0),q=this.json.skinsName[_],z={};for(l=0,M=this.readInt(!0);l<M;l++){h=this.readInt(!0);for(var D=this.json.slots[h],G={},K=0,L=this.readInt(!0);K<L;K++){var Q=this.readString();for(v=this.readInt(!0),m=new Array(v),f=0;f<v;f++){u=this.readFloat();var U=this.readInt(!0);if(m[f]={},m[f].time=u,0!=U){var Z=new Array(U),$=this.readInt(!0);if(1==this.scale)for(var tt=0;tt<U;tt++)Z[tt]=this.readFloat();else for(tt=0;tt<U;tt++)Z[tt]=this.readFloat()*this.scale;m[f].offset=$,m[f].vertices=Z}f<v-1&&this.readCurve(f,m)}G[Q]=m,r=Math.max(r,m[v-1].time)}z[D.name]=G}J[q]=z}e.deform=J;var et=this.readInt(!0);if(et>0){var at=new Array(et);for(i=0;i<et;i++){var rt={},st=(u=this.readFloat(),this.readInt(!0)),it=new Array(st);for(l=0;l<st;l++){var nt={};h=this.readInt(!0);nt.slot=this.json.slots[h].name;var ht=this.readInt(!0);nt.offset=ht,it[l]=nt}rt.offsets=it,rt.time=u,at[i]=rt}r=Math.max(r,at[et-1].time),e.drawOrder=at}var ot=this.readInt(!0);if(ot>0){var dt=new Array(ot);for(i=0;i<ot;i++){u=this.readFloat(),t=this.json.eventsName[this.readInt(!0)];var lt=this.json.events[t],ct={};ct.name=t,ct.int=this.readInt(!1),ct.float=this.readFloat(),ct.string=this.readBoolean()?this.readString():lt.string,ct.time=u,dt[i]=ct}r=Math.max(r,dt[ot-1].time),e.events=dt}return e}};var BlendMode=["normal","additive","multiply","screen"],AttachmentType=["region","boundingbox","mesh","linkedmesh","path","point","clipping"],TransformMode=["normal","onlyTranslation","noRotationOrReflection","noScale","noScaleOrReflection"],PositionMode=["fixed","percent"],SpacingMode=["length","fixed","percent"],RotateMode=["tangent","chain","chainScale"];
